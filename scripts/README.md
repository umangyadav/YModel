# Tune Convolutions through MIOpenDriver
1. find out convolution configs to pass to MIOpenDriver. Build MIGraphX with `-DMIGRAPHX_USE_FIND_2_API=Off`. This flag can be passed to either `rbuild` or `cmake` during build process. Steps to build MIGraphX can be found [here](https://github.com/ROCmSoftwarePlatform/AMDMIGraphX#building-from-source).
2. Run `bash dump_conv_configs.sh /path/to/migraphx-driver /path/to/model "additiona arguments to driver"` e.g. `bash dump_config.sh /opt/rocm/bin/migraphx-driver /home/umayadav/resnet50.onnx "--batch 32"`.  After it has finished running, it would produce two files with `.conv` extensions. One file contains conv configs with Fusion enabled and other file contains conv configs without fusions. These `.conv` file should contains commands to run `MIOpenDriver`. 
For example, one of the lines in `.conv` file could be `./bin/MIOpenDriver conv -n 1 -c 3 -H 224 -W 224 -k 52 -y 7 -x 7 -p 3 -q 3 -u 2 -v 2 -l 1 -j 1 -m conv -g 1 -F 1 -t 1 -S 0`
3. Run `python3 tune_conv_configs.py --rocm-path /path/to/rocm --conv-config /path/to/conv/config`. This python script would declare necessary environment variables to do MIOpen logging and tuning. It spins multiple processes that each call to `MIOpenDriver`.  Example invocation is `python3 tune_conv_configs.py --rocm-path /opt/rocm --conv-config /home/umayadav/resnet50.onnx_fusion.conv` . Run this script on both `.conv` files to tune MIOpen. 
   